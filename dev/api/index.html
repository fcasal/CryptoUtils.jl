<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Functions · CryptoUtils.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>CryptoUtils.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li class="current"><a class="toctext" href>Functions</a><ul class="internal"><li><a class="toctext" href="#Number-to-bytes-conversion-1">Number to bytes conversion</a></li><li><a class="toctext" href="#Prime-numbers-1">Prime numbers</a></li><li><a class="toctext" href="#Number-theory-1">Number theory</a></li><li><a class="toctext" href="#Cryptography-1">Cryptography</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Functions</a></li></ul><a class="edit-page" href="https://github.com/fcasal/CryptoUtils.jl/blob/master/docs/src/api.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Functions</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="CryptoUtils-1" href="#CryptoUtils-1">CryptoUtils</a></h1><h2><a class="nav-anchor" id="Number-to-bytes-conversion-1" href="#Number-to-bytes-conversion-1">Number to bytes conversion</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.b2n" href="#CryptoUtils.b2n"><code>CryptoUtils.b2n</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">b2n(str::String) -&gt; BigInt</code></pre><p>Converts a byte-string to a number, converting the string from base 256 to base 10.</p><pre><code class="language-julia">julia&gt; b2n(&quot;Hello world!&quot;)
22405534230753963835153736737</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L571-L582">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.n2b" href="#CryptoUtils.n2b"><code>CryptoUtils.n2b</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">n2b(n::Integer) -&gt; String</code></pre><p>Converts a number to its bytes representation, effectively writing the number in base 256, and returning the corresponding bytes.</p><pre><code class="language-julia">julia&gt; n2b(22405534230753963835153736737)
&quot;Hello world!&quot;</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L548-L559">source</a></section><h2><a class="nav-anchor" id="Prime-numbers-1" href="#Prime-numbers-1">Prime numbers</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.random_prime" href="#CryptoUtils.random_prime"><code>CryptoUtils.random_prime</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">random_prime(bitsize::Integer) -&gt; BigInt</code></pre><p>Return a random prime with <code>bitsize</code> bits.</p><pre><code class="language-none">julia&gt; random_prime(42)
2458636110727</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L418-L427">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.safe_prime" href="#CryptoUtils.safe_prime"><code>CryptoUtils.safe_prime</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">safe_prime(bitsize::Integer) -&gt; BigInt</code></pre><p>Return a random safe-prime <code>q</code> of the form <code>q = 2 * p + 1</code> where <code>p</code> is also a prime number. The returning prime number has <code>bitsize</code> bits.</p><pre><code class="language-none">julia&gt; safe_prime(10)
1439</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L465-L476">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.tower_two_prime" href="#CryptoUtils.tower_two_prime"><code>CryptoUtils.tower_two_prime</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">tower_two_prime(bitsize::Integer, tower_len::Integer) -&gt; BigInt</code></pre><p>Return a random prime of the form <code>2^towerlen * q + 1</code> with <code>bitsize</code> bits and where <code>q</code> is also a prime.</p><pre><code class="language-none">julia&gt; tower_two_prime(22, 6)
2362433</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L441-L451">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.get_first_primes" href="#CryptoUtils.get_first_primes"><code>CryptoUtils.get_first_primes</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">get_first_primes(k::Integer) -&gt; Collection</code></pre><p>Output the first <code>k</code> prime numbers.</p><pre><code class="language-julia">julia&gt; get_first_primes(10)
10-element Array{Int64,1}:
2
3
5
7
11
13
17
19
23
29</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L489-L509">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.twin_primes" href="#CryptoUtils.twin_primes"><code>CryptoUtils.twin_primes</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">twin_primes(bitsize::Integer)</code></pre><p>Return a pair of prime numbers <code>p, p + 2</code> with <code>bitsize</code> bits.</p><p>This might take a while to run.</p></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L523-L530">source</a></section><h2><a class="nav-anchor" id="Number-theory-1" href="#Number-theory-1">Number theory</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.find_quadratic_non_residue" href="#CryptoUtils.find_quadratic_non_residue"><code>CryptoUtils.find_quadratic_non_residue</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">find_quadratic_non_residue(p::Integer)</code></pre><p>Return a random number <code>R</code> which has no square root mod <code>p</code>, i.e., <code>x^2 == R mod p</code> has no solutions.</p></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L73-L78">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.is_quadratic_residue" href="#CryptoUtils.is_quadratic_residue"><code>CryptoUtils.is_quadratic_residue</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">is_quadratic_residue(a::Integer, p::Integer) -&gt; Bool</code></pre><p>Return true or false depending on wheter <code>a</code> is a quadratic residue mod <code>p</code>.</p><p>That is, it checks if <code>x^2 == a mod p</code> has solutions.</p></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L174-L180">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.sqrt_mod_prime" href="#CryptoUtils.sqrt_mod_prime"><code>CryptoUtils.sqrt_mod_prime</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">sqrt_mod_prime(a::Integer, p::Integer) -&gt; Integer</code></pre><p>Solves <code>x^2 == a mod p</code> and returns one of the square roots <code>r</code>. The other root is <code>p - r</code>. If there are no solutions, throws an exception.</p><pre><code class="language-julia">julia&gt; sqrt_mod_prime(33^2, 73)
33</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L190-L201">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.jacobi" href="#CryptoUtils.jacobi"><code>CryptoUtils.jacobi</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">jacobi(n::Integer, k::Integer)</code></pre><p>Return the Jacobi symbol of <code>n, k</code>.</p><p><code>k</code> should be an odd number.</p></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L38-L44">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.legendre" href="#CryptoUtils.legendre"><code>CryptoUtils.legendre</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">legendre(a::Integer, p::Integer)</code></pre><p>Return the Legendre symbol of <code>(a, p)</code>.</p><p><code>p</code> should be an odd prime number.</p></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L20-L26">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.continued_fraction" href="#CryptoUtils.continued_fraction"><code>CryptoUtils.continued_fraction</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">continued_fraction(a::T, b::T) where T &lt;: Integer</code></pre><p>Return the continued fraction of the rational <code>a/b</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; continued_fraction(31, 73)
6-element Array{Int64,1}:
 0
 2
 2
 1
 4
 2</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L236-L252">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.convergents" href="#CryptoUtils.convergents"><code>CryptoUtils.convergents</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">convergents(a::T, b::T) where T &lt;: Integer</code></pre><p>Return the convergents of a rational <code>a/b</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; convergents(31, 73)
6-element Array{Rational,1}:
  0//1
  1//2
  2//5
  3//7
 14//33
 31//73</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L270-L286">source</a><div><div><pre><code class="language-none">convergents(cont_fraction::Array)</code></pre><p>Return the convergents given the continued fraction of a rational.</p></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L295-L299">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.surd" href="#CryptoUtils.surd"><code>CryptoUtils.surd</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">surd(n::BigInt, k::Int64)</code></pre><p>Return largest integer smaller or equal than the <code>k</code>-th root of <code>n</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L333-L337">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.hoc_sqrt" href="#CryptoUtils.hoc_sqrt"><code>CryptoUtils.hoc_sqrt</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">hoc_sqrt(a::Integer, p::Integer)</code></pre><p>Algorithm from Handbook of cryptography, Koblitz pp 48-49. Finds a solution to <code>x^2 == a mod p</code>.</p><p>It assumes such solution exists.</p><p>Running time highly depends on |alpha|, assuming <code>p-1 = 2^alpha * s</code>, for an odd <code>s</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L134-L144">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.tonelli_shanks" href="#CryptoUtils.tonelli_shanks"><code>CryptoUtils.tonelli_shanks</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">tonelli_shanks(a::Integer, p::Integer)</code></pre><p>Implements the Tonelli Shanks algorithm for computing square roots modulo a prime number.</p><p>It assumes such square roots exist.</p></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L92-L99">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.is_generator" href="#CryptoUtils.is_generator"><code>CryptoUtils.is_generator</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">is_generator(g::Integer, q::Integer, factors::Array) -&gt; Bool</code></pre><p>Returns true if <code>g</code> is a generator of <code>Z_q</code> where <code>q</code> is prime and <code>factors</code> is the prime factorization of <code>q - 1 = p1^e1 * p2^e2 ... * pk^ek</code>.</p><pre><code class="language-none">q = 2^7 * 5 + 1
is_generator(2, q, [2, 5]) -&gt; false
is_generator(3, q, [2, 5]) -&gt; true</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L363-L374">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.get_safe_prime_generator" href="#CryptoUtils.get_safe_prime_generator"><code>CryptoUtils.get_safe_prime_generator</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">get_safe_prime_generator(q::BigInt) -&gt; BigInt</code></pre><p>Returns a generator of <code>Z_q</code>, where <code>q = 2 * p + 1</code> with <code>q, p</code> primes.</p></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L389-L393">source</a></section><h2><a class="nav-anchor" id="Cryptography-1" href="#Cryptography-1">Cryptography</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.factor_with_ed" href="#CryptoUtils.factor_with_ed"><code>CryptoUtils.factor_with_ed</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">factor_with_ed(n::Integer, e::Integer, d::Integer) -&gt; (Integer, Integer)</code></pre><p>Factors <code>n = p*q</code> given <code>(e, d)</code> such that <code>e*d = 1 mod phi(n)</code> Stinson page 204 - algorithm 5.10</p></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L598-L603">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CryptoUtils.wiener" href="#CryptoUtils.wiener"><code>CryptoUtils.wiener</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">wiener(n::Integer, e::Integer, dujella_bound=20)</code></pre><p>Factors the semiprime <code>n</code>, assuming Wiener&#39;s attack holds: <code>d &lt; n^(1/4)</code>, where <code>d*e = 1 mod phi(n)</code>.</p><p>Uses Dujella extension attack. Increasing the <code>dujella_bound</code> argument slows the running time but increases chances of finding the correct <code>d</code> in case <code>d ~ n^(1/4)</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/fcasal/CryptoUtils.jl/blob/b07e325dddc83a92c93c331a34d3cbc7c256d156/src/CryptoUtils.jl#L641-L650">source</a></section><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">Home</span></a></footer></article></body></html>
